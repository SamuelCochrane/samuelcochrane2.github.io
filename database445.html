<!DOCTYPE HTML>
<html>
	<head>
		<title>Database 445 - Samuel Cochrane</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-loading">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo">Samuel Cochrane</a>
					</header>
					<!-- Nav -->
						<nav id="nav">
							<ul class="links">
								<li><a href="index.html">Back to Portfolio</a></li>
								<li class="active"><a href="checkout.html">Database 445</a></li>
								<!-- <li><a href="elements.html">Elements Reference</a></li> -->
							</ul>
							<ul class="icons">
								<li><a href="https://twitter.com/SamuelDCochrane" class="icon fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
								<li><a href="https://www.instagram.com/notamalemodel/" class="icon fa-instagram" target="_blank"><span class="label">Instagram</span></a></li>
								<!-- <li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li> -->
								<li><a href="images/snapcode.jpg" class="icon fa-snapchat-ghost" target="_blank"><span class="label">Snapchat</span></a></li>
								<li><a href="https://github.com/SamuelCochrane" class="icon fa-github-alt" target="_blank"><span class="label">GitHub</span></a></li>
								<li><a href="mailto:SamuelDavisCochrane@gmail.com" class="icon fa-envelope" target="_blank"><span class="label">Email</span></a></li>
								<li><a href="https://www.linkedin.com/in/sam-cochrane-aaa325110/" class="icon fa-linkedin" target="_blank"><span class="label">linkedin</span></a></li>
							</ul>
						</nav>
						<!-- Main -->
							<div id="main">

								<!-- Post -->
									<section class="post">
										<header class="major">
											<span class="date">March 6, 2017</span>
											<h1>445 Consulting<br />
											 Database</h1>
											<p>Fully functional relational database design for a fictional consulting company (<em>445 Consulting</em>). Includes multiple stored procedures, business rules, views, and calculated columns. Built using SQLServer and Visio.
											<br>Final project for INFO 445 - Advanced Database Design.</br>

											</p>
											</header>
										</header>
										<div class="image main"><img src="images/445_fullErd.PNG" alt="" /></div>
										<hr>
										<p>
											As a final project for INFO 445, Advanced Database Design, I was tasked with building a fully functional and complex database.
											<br>The database was built to fulfil the needs of a fictional consulting company. The database as such tracks projects (including tasks, skills, and assigned employees),
											as well as client companies, allowing the consulting company to easily track its projects, resources, and clients.
										</p>
										<p>
											This database is fully normalized, with no data redundancy or possibility for 'infinite loops'.
											The final submission included several Stored Procecures for insertion of complex data (such as assigning an employee to a project with specific tasks).
											The DB also includes several business rules that automatically send out alerts after certain actions are flagged, such as redundant skills being added for an employee, or an employee being assigned to too many active projects.
										</p>
										<hr>
										<h2>Example Code Snippets:</h2>
										<header><h4>Stored Procedure</h4> <p>Add a salary history (a salary the employee was paid at one point)</p></header>
										<pre><code>CREATE PROC uspAddSalaryHistory
@Fname varchar(100),
@Lname varchar(100),
@DOB DATE,
@Position varchar(100),
@Company varchar(100),
@Amount MONEY,
@BeginDate DATE,
@EndDate DATE
AS
DECLARE @PositionID INT
DECLARE @CompanyID INT
DECLARE @EmpID INT
DECLARE @EmpHistoryID INT
BEGIN
SET @PositionID = (
	SELECT PositionID FROM [POSITION]
	WHERE PositionName = @Position
)
IF @PositionID IS NULL
	RAISERROR('Position name not valid', 12, 1)
SET @CompanyID = (
	SELECT CompanyID FROM [COMPANY]
	WHERE CompanyName = @Company
)
IF @CompanyID IS NULL
	RAISERROR('Company name not valid', 12, 1)
SET @EmpID = (
	SELECT EmployeeID FROM [EMPLOYEE]
	WHERE FName = @Fname
	AND LName = @Lname
	AND DOB = @DOB
)
IF @CompanyID IS NULL
	RAISERROR('Personal info not valid', 12, 1)
SET @EmpHistoryID = (
	SELECT EmploymentHistoryID FROM [EMPLOYMENT_HISTORY]
	WHERE EmployeeID = @EmpID
	AND PositionID = @PositionID
	AND CompanyID = @CompanyID
)
IF @EmpHistoryID IS NULL
	RAISERROR('Data mismatch (person not found to have that job at that company)', 12, 1)

BEGIN TRAN TranNewSalaryHistory
	INSERT INTO [SALARY_HISTORY]([EmploymentHistoryID], BeginDate, EndDate, Amount)
	VALUES (@EmpHistoryID, @BeginDate, @EndDate, @Amount)
	IF @@Error <> 0
		ROLLBACK TRAN TranNewSalaryHistory
	ELSE
		COMMIT TRAN TranNewSalaryHistory
END
										</code></pre>
<br>
									<header><h4>Check Constraint</h4><p>Employees can't have two instances of the same skill</p></header>
										<pre><code>CREATE FUNCTION fn_LimitEmployeeSkillDuplicates()
RETURNS INT
AS
BEGIN
DECLARE @RET INT = 0
IF EXISTS (SELECT COUNT(*), SE.EmployeeID, SE.SkillID FROM SKILL_EMPLOYEE SE
	GROUP BY SE.SkillID, SE.EmployeeID
	HAVING COUNT(*) > 1)
		SET @RET = 1
RETURN @RET
END
GO

ALTER TABLE SKILL_EMPLOYEE WITH NOCHECK
ADD CONSTRAINT ck_LimitEmployeeSkillDuplicates
CHECK (dbo.fn_LimitEmployeeSkillDuplicates() = 0)
</code></pre>
<br>
									<header><h4>Computed Column</h4><p>Number of employees assigned to a project</p></header>
										<pre><code>CREATE FUNCTION dbo.getNumProjectEmployees(@ProjectID int)
RETURNS int
AS
BEGIN
    DECLARE @RET int
    SELECT @RET = COUNT(*) FROM PROJECT_EMPLOYEE PE WHERE PE.ProjectID = @ProjectID
    RETURN @RET
END

ALTER TABLE PROJECT ADD NumEmployeesAssigned AS (dbo.getNumProjectEmployees(ProjectID))
</code></pre>
<br>

<header><h4>View</h4><p>Project tasks (description, assigned employee)</p></header>
	<pre><code>CREATE VIEW taskView
AS
SELECT p.ProjectName AS 'Project Name', p.ProjectDescription AS 'Project Description', e.FullName AS 'Employee Name', t.TaskName AS 'Task Name', t.TaskDesc AS 'Task Description'
FROM TASK t
JOIN PROJECT_EMPLOYEE pe ON t.ProjectEmployeeID = pe.ProjectEmployeeID
JOIN EMPLOYEE e ON pe.EmployeeID = e.EmployeeID
JOIN PROJECT p ON pe.ProjectID = p.ProjectID
GO
</code></pre>
										</section>

										</div>

										<!-- Footer -->
										<footer id="footer">

										<section><center>
										<ul class="icons alt">
											<li><a href="https://twitter.com/SamuelDCochrane" class="icon fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
											<li><a href="https://www.instagram.com/notamalemodel/" class="icon fa-instagram" target="_blank"><span class="label">Instagram</span></a></li>
											<!-- <li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li> -->
											<li><a href="images/snapcode.jpg" class="icon fa-snapchat-ghost" target="_blank"><span class="label">Snapchat</span></a></li>
											<li><a href="https://github.com/SamuelCochrane" class="icon fa-github-alt" target="_blank"><span class="label">GitHub</span></a></li>
											<li><a href="mailto:SamuelDavisCochrane@gmail.com" class="icon fa-envelope" target="_blank"><span class="label">Email</span></a></li>
											<li><a href="https://www.linkedin.com/in/sam-cochrane-aaa325110/" class="icon fa-linkedin" target="_blank"><span class="label">linkedin</span></a></li>
										</ul>
										</section></center>
										</section>
										</footer>

										<!-- Copyright -->
										<div id="copyright">
										<ul><li>&copy; COCHRANE, SAMUEL DAVIS </li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
										</div>
										<!--
										Massively Template by HTML5 UP
										html5up.net | @ajlkn
										Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
										-->
										</div>

										<!-- Scripts -->
										<script src="assets/js/jquery.min.js"></script>
										<script src="assets/js/jquery.scrollex.min.js"></script>
										<script src="assets/js/jquery.scrolly.min.js"></script>
										<script src="assets/js/skel.min.js"></script>
										<script src="assets/js/util.js"></script>
										<script src="assets/js/main.js"></script>

										</body>
										</html>
